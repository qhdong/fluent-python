# 函数是一等公民

在 Python 中函数和其他对象一样是一级支持的。

## 其中可调用对象类型

- 用户定义函数
- 内置函数，比如 `len`
- 内置方法，比如 `dict.get`
- 类方法
- 类，当类被调用时会执行 `__new__()`实例化对象，然后`__init__()`初始化
- 定义了 `__call__()` 的类实例对象
- 生成器函数，调用后会返回一个生成器

在 Python 中任何对象只要有 `__call__(self)` 方法就可以被调用，这类似于 C++ 中的函数对象，
相较于传统的函数，对象有着可以保存状态的天然优势，比如最常见的 Python 中的装饰器来实现缓存。

还有其他的技术可以实现保存状态，比如 **闭包**

## 函数参数

Python 中函数的参数非常灵活，可以是位置参数，也可以有关键词参数，也可以两者混合，如果希望强制关键词参数，
可以这么做

```python
def f(a, *, b):
    pass

f(2, b=3)
```

`*`后面的参数必须使用关键词方式给定，通常认为这是一个很好的实践，关键词参数更易读。

如何从代码中获取参数信息呢？ 通过 `inspect.signature(func)` 函数可以很方便的获取函数的参数信息，
另外也可以通过如下代码获得。

```python
def foo(a, b=3):
    pass
    
# 获取参数的默认值
print(foo.__defaults__)

# 获取函数的变量名
print(foo.__code__.co_varnames)

# 获取函数的参数个数
print(foo.__code__.co_argcount)
```

有了以上信息，就可以推测出函数的参数信息了，当然这样操作比较原始，还是推荐使用 `inspect` 模块。
事实上很多 framework 和 IDE 都是用这些工具来获得函数的参数信息来做自动校验或类型推导的。


## Annotation 注解

Python3 中开始支持注解，形式如下所示：

```python
def clip(text: str, max_len: 'int > 0'=80) -> str:
    pass
```

注解对于 Python 解释器而言没有任何意义，就像注释一样，然而其他框架可以提取这些信息来做一些有意义的事情，
比如 IDE 的自动补全，代码检查工具的静态类型检查等。



